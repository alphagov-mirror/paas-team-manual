<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">

    <title>PaaS Team Manual</title>

    <!--[if gt IE 8]><!--><link href="../../stylesheets/screen.css" rel="stylesheet" media="screen" /><!--<![endif]-->
    <!--[if lte IE 8]><link href="../../stylesheets/screen-old-ie.css" rel="stylesheet" media="screen" /><![endif]-->

    <link rel="canonical" href="https://team-manual.cloud.service.gov.uk/monitoring_alerting/prometheus/">


    <link href="../../stylesheets/print.css" rel="stylesheet" media="print" />
    <script src="../../javascripts/application.js"></script>

      <meta property="og:image" content="https://team-manual.cloud.service.gov.uk/images/govuk-large.png" />
      <meta property="og:site_name" content="PaaS Team Manual" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://team-manual.cloud.service.gov.uk/monitoring_alerting/prometheus/" />
      <meta property="twitter:card" content="summary" />
      <meta property="twitter:domain" content="team-manual.cloud.service.gov.uk" />
      <meta property="twitter:image" content="https://team-manual.cloud.service.gov.uk/images/govuk-large.png" />
      <meta property="twitter:title" content="PaaS Team Manual" />
      <meta property="twitter:url" content="https://team-manual.cloud.service.gov.uk/monitoring_alerting/prometheus/" />

    
  </head>

  <body>
    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="skip-link">Skip to main content</a>

        <header class="header header--full-width">
  <div class="header__container">
    <div class="header__brand">
        <a href="https://team-manual.cloud.service.gov.uk">
        <span class="header__title">
          PaaS Team Manual
            <span class="phase-banner">Internal</span>
        </span>
        </a>
    </div>

  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <a href="#toc" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </a>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents">
              
              <a href="#" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></a>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                      <ul>
  <li>
    <a href="#prometheus">Prometheus</a>
    <ul>
      <li>
        <a href="#high-availability">High availability</a>
      </li>
      <li>
        <a href="#alerting">Alerting</a>
      </li>
      <li>
        <a href="#urls">URLs</a>
        <ul>
          <li>
            <a href="#primary">Primary</a>
          </li>
          <li>
            <a href="#secondary">Secondary</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              <div class="page-banner">
    <p>This is for internal use by the PaaS team. Public-facing documentation is located at <a href="https://docs.cloud.service.gov.uk">docs.cloud.service.gov.uk</a>.</p>
  </div>

  <h1 id="prometheus">Prometheus</h1><h2 id="high-availability">High availability</h2><p>All components run at least on two different VMs in different availability zones.</p>
<p>All Prometheus instances are independent and scrape the metrics endpoints separately. This means the Prometheus instances will have slightly different data (because of different scraping times). For various reasons (downtime, restart, etc.) one Prometheus instance might also have some data missing compared to the others.</p>
<p>All Prometheus instances will send alerts to all alertmanagers. The alertmanagers form a separate cluster and will deduplicate any identical alerts.</p>
<p>The Grafana instances will connect only to the Prometheus instance which is in the same availability zone.</p>
<p>All instances have a unique url, so in case of an AZ failure you can use the monitoring urls from the working AZ.</p>
<h2 id="alerting">Alerting</h2><p>Prometheus is configured to send alerts to teams mailing lists.</p>
<p>You can find these mailing lists <a href="/team/platform_alerting/">here</a>.</p>
<h2 id="urls">URLs</h2><h3 id="primary">Primary</h3><div class="table-container">
        <table>
          <tr>
<th>Ireland</th>
<th>UK</th>
</tr>
<tr>
<td><a href="https://prometheus-1.cloud.service.gov.uk">prometheus-1.cloud.service.gov.uk</a></td>
<td><a href="https://prometheus-1.london.cloud.service.gov.uk">prometheus-1.london.cloud.service.gov.uk</a></td>
</tr>
<tr>
<td><a href="https://alertmanager-1.cloud.service.gov.uk">alertmanager-1.cloud.service.gov.uk</a></td>
<td><a href="https://alertmanager-1.london.cloud.service.gov.uk">alertmanager-1.london.cloud.service.gov.uk</a></td>
</tr>
<tr>
<td><a href="https://grafana-1.cloud.service.gov.uk">grafana-1.cloud.service.gov.uk</a></td>
<td><a href="https://grafana-1.london.cloud.service.gov.uk">grafana-1.london.cloud.service.gov.uk</a></td>
</tr>

        </table>
      </div><h3 id="secondary">Secondary</h3><div class="table-container">
        <table>
          <tr>
<th>Ireland</th>
<th>UK</th>
</tr>
<tr>
<td><a href="https://prometheus-2.cloud.service.gov.uk">prometheus-2.cloud.service.gov.uk</a></td>
<td><a href="https://prometheus-2.london.cloud.service.gov.uk">prometheus-2.london.cloud.service.gov.uk</a></td>
</tr>
<tr>
<td><a href="https://alertmanager-2.cloud.service.gov.uk">alertmanager-2.cloud.service.gov.uk</a></td>
<td><a href="https://alertmanager-2.london.cloud.service.gov.uk">alertmanager-2.london.cloud.service.gov.uk</a></td>
</tr>
<tr>
<td><a href="https://grafana-2.cloud.service.gov.uk">grafana-2.cloud.service.gov.uk</a></td>
<td><a href="https://grafana-2.london.cloud.service.gov.uk">grafana-2.london.cloud.service.gov.uk</a></td>
</tr>

        </table>
      </div>

            
          </main>


          <footer class="footer">
  <div class="footer__licence">
    <a class="footer__licence-logo" href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence</a>
    <p class="footer__licence-description">All content is available under the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence v3.0</a>, except where otherwise stated</p>
  </div>

  <div class="footer__copyright">
    <a class="footer__copyright-logo" href="http://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/copyright-and-re-use/crown-copyright/">Â© Crown copyright</a>
  </div>
</footer>

        </div>
      </div>
    </div>

    
  </body>
</html>
