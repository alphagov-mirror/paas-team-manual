<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">

    <title>PaaS Team Manual</title>

    <!--[if gt IE 8]><!--><link href="../../stylesheets/screen.css" rel="stylesheet" media="screen" /><!--<![endif]-->
    <!--[if lte IE 8]><link href="../../stylesheets/screen-old-ie.css" rel="stylesheet" media="screen" /><![endif]-->

    <link rel="canonical" href="https://team-manual.cloud.service.gov.uk/styleguides/concourse_pipeline/">


    <link href="../../stylesheets/print.css" rel="stylesheet" media="print" />
    <script src="../../javascripts/application.js"></script>

      <meta property="og:image" content="https://team-manual.cloud.service.gov.uk/images/govuk-large.png" />
      <meta property="og:site_name" content="PaaS Team Manual" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://team-manual.cloud.service.gov.uk/styleguides/concourse_pipeline/" />
      <meta property="twitter:card" content="summary" />
      <meta property="twitter:domain" content="team-manual.cloud.service.gov.uk" />
      <meta property="twitter:image" content="https://team-manual.cloud.service.gov.uk/images/govuk-large.png" />
      <meta property="twitter:title" content="PaaS Team Manual" />
      <meta property="twitter:url" content="https://team-manual.cloud.service.gov.uk/styleguides/concourse_pipeline/" />

    
  </head>

  <body>
    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="skip-link">Skip to main content</a>

        <header class="header header--full-width">
  <div class="header__container">
    <div class="header__brand">
        <a href="https://team-manual.cloud.service.gov.uk">
        <span class="header__title">
          PaaS Team Manual
            <span class="phase-banner">Internal</span>
        </span>
        </a>
    </div>

  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <a href="#toc" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </a>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents">
              
              <a href="#" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></a>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                      <ul>
  <li>
    <a href="#concourse-pipelines">Concourse pipelines</a>
    <ul>
      <li>
        <a href="#triggering-patterns">Triggering patterns</a>
      </li>
      <li>
        <a href="#tasks">Tasks</a>
        <ul>
          <li>
            <a href="#naming">Naming</a>
          </li>
          <li>
            <a href="#ordering-of-sections">Ordering of sections</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              <div class="page-banner">
    <p>This is for internal use by the PaaS team. Public-facing documentation is located at <a href="https://docs.cloud.service.gov.uk">docs.cloud.service.gov.uk</a>.</p>
  </div>

  <h1 id="concourse-pipelines">Concourse pipelines</h1><p>This documents some of the agreed styles we have to writing <a href="https://concourse-ci.org">Concourse</a>
pipelines. Because these are written in YAML, the <a href="../YAML/">YAML styleguide</a> also
applies.</p>
<h2 id="triggering-patterns">Triggering patterns</h2><p>Most of our pipelines follow the following pattern for triggering jobs. This
should be used unless there&rsquo;s a good reason not to.</p>
<p>Pipelines start with an <code>init</code> job that bumps a <code>pipeline-trigger</code> semver
resource. This resource is then used to trigger everything else througout the
pipeline. This ensures that all of a pipeline runs, even if some of the
jobs/tasks are a no-op. It also means there is a consistent way to initiate a
pipeline run (where they are triggered manually).</p>
<h2 id="tasks">Tasks</h2><h3 id="naming">Naming</h3><p>Tasks should be given names that are verbs. Inputs and outputs should be given
names that are nouns. Inputs and outputs should not be given names that are the
same as a task name.</p>
<p>For example a task that takes a terraform state file and extracts the outputs
should be named as follows:
<code>yaml
- task: extract-terraform-outputs
  config:
    # ...
    inputs:
      - name: paas-cf
      - name: foo-tfstate
    outputs:
      - name: terraform-outputs
    run:
      # ...
</code></p>
<h3 id="ordering-of-sections">Ordering of sections</h3><p>Task config section should be ordered as follows:</p>

<ul>
<li><code>platform</code></li>
<li><code>image</code> or <code>image_resource</code></li>
<li><code>inputs</code></li>
<li><code>outputs</code></li>
<li><code>params</code></li>
<li><code>run</code></li>
</ul>
<p>This makes it easier to follow the flow of a task and see what it operates on.</p>


            
          </main>


          <footer class="footer">
  <div class="footer__licence">
    <a class="footer__licence-logo" href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence</a>
    <p class="footer__licence-description">All content is available under the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence v3.0</a>, except where otherwise stated</p>
  </div>

  <div class="footer__copyright">
    <a class="footer__copyright-logo" href="http://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/copyright-and-re-use/crown-copyright/">Â© Crown copyright</a>
  </div>
</footer>

        </div>
      </div>
    </div>

    
  </body>
</html>
